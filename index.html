<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.9.2 from src/site/markdown/index.md at 06.01.2022 04:13:238
 | Rendered using Apache Maven Fluido Skin 1.7
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20220106" />
    <meta http-equiv="Content-Language" content="en" />
    <title>common-xml &#x2013; Common XML</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.7.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script type="text/javascript" src="./js/apache-maven-fluido-1.7.min.js"></script>
  </head>
  <body class="topBarDisabled">
    <div class="container-fluid">
      <div id="banner">
        <div class="pull-left"><a href="./" id="bannerLeft"><h2>common-xml</h2>
</a></div>
        <div class="pull-right"></div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
        <li id="projectVersion">Version: 2.3.1</li>
        <li id="publishDate" class="pull-right">Last Published: 06.01.2022 04:13:238</li>
        </ul>
      </div>
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
    <ul class="nav nav-list">
      <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-down"></span>Project Information</a>
    <ul class="nav nav-list">
    <li><a href="dependencies.html" title="Dependencies"><span class="none"></span>Dependencies</a></li>
    <li><a href="dependency-info.html" title="Dependency Information"><span class="none"></span>Dependency Information</a></li>
    <li><a href="dependency-management.html" title="Dependency Management"><span class="none"></span>Dependency Management</a></li>
    <li><a href="distribution-management.html" title="Distribution Management"><span class="none"></span>Distribution Management</a></li>
    <li class="active"><a href="#"><span class="none"></span>About</a></li>
    <li><a href="issue-management.html" title="Issue Management"><span class="none"></span>Issue Management</a></li>
    <li><a href="licenses.html" title="Licenses"><span class="none"></span>Licenses</a></li>
    <li><a href="plugin-management.html" title="Plugin Management"><span class="none"></span>Plugin Management</a></li>
    <li><a href="plugins.html" title="Plugins"><span class="none"></span>Plugins</a></li>
    <li><a href="scm.html" title="Source Code Management"><span class="none"></span>Source Code Management</a></li>
    <li><a href="summary.html" title="Summary"><span class="none"></span>Summary</a></li>
    <li><a href="team.html" title="Team"><span class="none"></span>Team</a></li>
    </ul>
</li>
    <li><a href="project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a></li>
</ul>
          <hr />
          <div id="poweredBy">
            <div class="clear"></div>
            <div class="clear"></div>
            <div class="clear"></div>
            <div class="clear"></div>
<a href="https://maven.apache.org/" title="Built by Maven" class="builtBy"><img class="builtBy"  alt="" src="#"    /></a>
            </div>
          </div>
        </div>
        <div id="bodyColumn"  class="span10" >
<h1>Common XML</h1>
<p>This library contains</p>
<ul>

<li>some xml adapters (for java.util.Date, java.time.Duration, java.time.Instant, java.time.OffsetDateTime etc.),</li>
<li>a pojo to describe an xml model (<code>JaxbContextData</code>) with package name, namespace and schema location,</li>
<li>a provider (<code>JaxbContextDataProvider</code>) of these descriptions that may be loaded with java.util.ServiceLoader into</li>
<li>a JAXB context builder (<code>JaxbContextBuilder</code>) which is able to generate a JAXB context on runtime,</li>
<li>a schema builder (<code>SchemaBuilder</code>)</li>
<li>and an xml document builder (<code>XmlDocumentBuilder</code>).</li>
</ul><section>
<h2><a name="Usage_of_JaxbContextBuilder"></a>Usage of JaxbContextBuilder</h2><section>
<h3><a name="XML_model_in_packages"></a>XML model in packages</h3>
<p>For example, there is an extensive xml model that has been generated from many xsd files, like my <a class="externalLink" href="https://github.com/bremersee/gpx-model">GPX</a> and <a class="externalLink" href="https://github.com/bremersee/garmin-model">Garmin</a> model, and you want to support them in your application.</p>
<p>All the packages which contain the model of the xsd files are described with <code>JaxbContextData</code> and are summed up in an implementation of <code>JaxbContextDataProvider</code> (see for example <a class="externalLink" href="https://github.com/bremersee/garmin-model/blob/master/src/main/java/org/bremersee/garmin/GarminJaxbContextDataProvider.java">GarminJaxbContextDataProvider</a>).</p>
<p>The implementation of the provider will be announced to the service loader by a service <a class="externalLink" href="https://github.com/bremersee/garmin-model/blob/master/src/main/resources/META-INF/services/org.bremersee.xml.JaxbContextDataProvider">description</a>.</p>
<p>Then it is very easy to generate the JAXBContext using the <code>JaxbContextBuilder</code>:</p>

<div class="source">
<div class="source"><pre class="prettyprint">import java.util.ServiceLoader;
import javax.xml.bind.JAXBContext;

public class Example {

  public static void main(String[] args) {
    JAXBContext jaxbContext = JaxbContextBuilder
        .builder()
        .processAll(ServiceLoader.load(JaxbContextDataProvider.class))
        .buildJaxbContext();
  }
}
</pre></div></div>

<p>Another advantage of using <code>JaxbContextData</code> is the possibility to add a schema location to an xml model that was generated with an xjc maven plugin, because the generated <code>package-info.java</code> files don&#x2019;t have information about the schema location and I haven&#x2019;t found a way to add the schema location during generation.</p>
<p>If such provider is not present, it is possible to add the packages in different ways and combine them:</p>

<div class="source">
<div class="source"><pre class="prettyprint">import javax.xml.bind.JAXBContext;

public class Example {

  public static void main(String[] args) {
    JAXBContext jaxbContext = JaxbContextBuilder
        .builder()
        .add(&quot;org.example.model.foo:org.example.model.bar&quot;)
        .add(new JaxbContextData(&quot;org.example.model.foobar&quot;))
        .buildJaxbContext();
  }
}
</pre></div></div>

<p>Important is that the packages, which contain the model, have a <code>package-info.java</code> annotated with <code>@javax.xml.bind.annotation.XmlSchema</code> and an <code>ObjectFactory.java</code> class. Packages that were generated with XJC normally have these.</p></section><section>
<h3><a name="Single_model_class"></a>Single model class</h3>
<p>The JaxbContextBuilder also supports model classes, which are not organized in a package. They only have to be annotated with <code>@XmlRootElement</code>:</p>

<div class="source">
<div class="source"><pre class="prettyprint">import javax.xml.bind.JAXBContext;
import javax.xml.bind.annotation.XmlRootElement;

public class Example {
  
  @XmlRootElement
  public static class Model {
    
    private String value;

    public String getValue() {
      return value;
    }

    public void setValue(String value) {
      this.value = value;
    }
  }

  public static void main(String[] args) {
    JAXBContext jaxbContext = JaxbContextBuilder
        .builder()
        .buildJaxbContext(Model.class);
  }
}
</pre></div></div>
</section><section>
<h3><a name="Dependency_resolving"></a>Dependency resolving</h3>
<p>So far it&#x2019;s not very amazing, the builder just wraps the factory methods of the <code>JAXBContext</code>. Let&#x2019;s go back to the idea that there is an extensive xml model that has been generated from many xsd files. If you marshal an object with that extensive jaxb context, you will get plenty of unnecessary name space declarations and schema locations.</p>

<div class="source">
<div class="source"><pre class="prettyprint">import java.io.StringWriter;
import java.util.ServiceLoader;
import javax.xml.bind.JAXBException;
import org.bremersee.garmin.gpx.v3.model.ext.DisplayColorT;
import org.bremersee.garmin.gpx.v3.model.ext.TrackExtension;
import org.bremersee.xml.JaxbContextBuilder;
import org.bremersee.xml.JaxbContextDataProvider;

public class Example {

  public static void main(String[] args) throws JAXBException {
    TrackExtension model = new TrackExtension();
    model.setDisplayColor(DisplayColorT.CYAN);

    StringWriter sw = new StringWriter();
    JaxbContextBuilder.builder()
        .withFormattedOutput(true)
        .processAll(ServiceLoader.load(JaxbContextDataProvider.class))
        .buildMarshaller() // builds a marshaller with the whole jaxb context
        .marshal(model, sw);
    System.out.println(sw.toString());
  }
}
</pre></div></div>

<p>The generated xml may look like this (the declaration is over 9000 characters long):</p>

<div class="source">
<div class="source"><pre class="prettyprint">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;ns30:TrackExtension xsi:schemaLocation=&quot;http://www.garmin.com/xmlschemas/AccelerationExtension/v1 http://bremersee.github.io/xmlschemas/garmin/AccelerationExtensionv1.xsd http://www.garmin.com/xmlschemas/ActiveItemExtensions/v1 http://bremersee.github.io/xmlschemas/garmin/ActiveItemExtensionv1.xsd http://www.garmin.com/xmlschemas/ActivityExtension/v1 http://bremersee.github.io/xmlschemas/garmin/ActivityExtensionv1.xsd http://www.garmin.com/xmlschemas/ActivityExtension/v2 http://bremersee.github.io/xmlschemas/garmin/ActivityExtensionv2.xsd http://www.garmin.com/xmlschemas/ActivityGoals/v1 http://bremersee.github.io/xmlschemas/garmin/ActivityGoalsExtensionv1.xsd http://www.garmin.com/xmlschemas/AdventuresExtensions/v1 http://bremersee.github.io/xmlschemas/garmin/AdventuresExtensionv1.xsd http://www.garmin.com/xmlschemas/CalorieBurnData/v1 http://bremersee.github.io/xmlschemas/garmin/CalorieBurnDataV1.xsd http://www.garmin.com/xmlschemas/ClientProfile/v1 http://bremersee.github.io/xmlschemas/garmin/clientprofilev1.xsd http://www.garmin.com/xmlschemas/ConverterPlugin/v1 http://bremersee.github.io/xmlschemas/garmin/ConverterPluginv1.xsd http://www.garmin.com/xmlschemas/CourseExtension/v1 http://bremersee.github.io/xmlschemas/garmin/CourseExtensionv1.xsd http://www.garmin.com/xmlschemas/CreationTimeExtension/v1 http://bremersee.github.io/xmlschemas/garmin/CreationTimeExtensionv1.xsd http://www.garmin.com/xmlschemas/DeviceDownload/v1 http://bremersee.github.io/xmlschemas/garmin/DeviceDownloadV1.xsd http://www.garmin.com/xmlschemas/DirectoryListing/v1 http://bremersee.github.io/xmlschemas/garmin/DirectoryListingV1.xsd http://www.garmin.com/xmlschemas/Eula/v1 http://bremersee.github.io/xmlschemas/garmin/Eulav1.xsd http://www.garmin.com/xmlschemas/FatCalories/v1 http://bremersee.github.io/xmlschemas/garmin/fatcalorieextensionv1.xsd http://www.garmin.com/xmlschemas/FitnessDeviceLimits/v1 http://bremersee.github.io/xmlschemas/garmin/FitnessDeviceLimitsv1.xsd http://www.garmin.com/xmlschemas/ForerunnerLogbook http://bremersee.github.io/xmlschemas/garmin/ForerunnerLogbookv1.xsd http://www.garmin.com/xmlschemas/GarminDevice/v1 http://bremersee.github.io/xmlschemas/garmin/GarminDevicev1.xsd http://www.garmin.com/xmlschemas/GarminDevice/v2 http://bremersee.github.io/xmlschemas/garmin/GarminDevicev2.xsd http://www.garmin.com/xmlschemas/GarminDeviceExtensions/DataTypeLocation/v1 http://bremersee.github.io/xmlschemas/garmin/DataTypeLocationExtension1.xsd http://www.garmin.com/xmlschemas/GarminDeviceExtensions/v1 http://bremersee.github.io/xmlschemas/garmin/GarminDeviceExtensionv1.xsd http://www.garmin.com/xmlschemas/GarminDeviceExtensions/v2 http://bremersee.github.io/xmlschemas/garmin/GarminDeviceExtensionv2.xsd http://www.garmin.com/xmlschemas/GarminMobileAppPathExtension/v1 http://bremersee.github.io/xmlschemas/garmin/GarminMobileAppPathExtensionv1.xsd http://www.garmin.com/xmlschemas/GarminOEMDeviceExtensions/v1 http://bremersee.github.io/xmlschemas/garmin/GarminOEMDeviceExtensionv1.xsd http://www.garmin.com/xmlschemas/GarminTextTranslation/v1 http://bremersee.github.io/xmlschemas/garmin/GarminTextTranslationv1.xsd http://www.garmin.com/xmlschemas/ggz/1/0 http://bremersee.github.io/xmlschemas/garmin/ggz.xsd http://www.garmin.com/xmlschemas/GpxExtensions/v1 http://bremersee.github.io/xmlschemas/garmin/GpxExtensionsv1.xsd http://www.garmin.com/xmlschemas/GpxExtensions/v2 http://bremersee.github.io/xmlschemas/garmin/GpxExtensionsv2.xsd http://www.garmin.com/xmlschemas/GpxExtensions/v3 http://bremersee.github.io/xmlschemas/garmin/GpxExtensionsv3.xsd http://www.garmin.com/xmlschemas/HardwareVersionExtension/v1 http://bremersee.github.io/xmlschemas/garmin/HardwareVersionExtensionv1.xsd http://www.garmin.com/xmlschemas/HistoryDatabase/v1 http://bremersee.github.io/xmlschemas/garmin/HistoryDatabasev1.xsd http://www.garmin.com/xmlschemas/iFixExtensions/v1 http://bremersee.github.io/xmlschemas/garmin/iFixExtensionv1.xsd http://www.garmin.com/xmlschemas/MobileExtensions/v1 http://bremersee.github.io/xmlschemas/garmin/MobileExtensionv1.xsd http://www.garmin.com/xmlschemas/PressureExtension/v1 http://bremersee.github.io/xmlschemas/garmin/PressureExtensionv1.xsd http://www.garmin.com/xmlschemas/ProfileExtension/v1 http://bremersee.github.io/xmlschemas/garmin/UserProfilePowerExtensionv1.xsd http://www.garmin.com/xmlschemas/TrackPointExtension/v1 http://bremersee.github.io/xmlschemas/garmin/TrackPointExtensionv1.xsd http://www.garmin.com/xmlschemas/TrackPointExtension/v2 http://bremersee.github.io/xmlschemas/garmin/TrackPointExtensionv2.xsd http://www.garmin.com/xmlschemas/TrackStatsExtension/v1 http://bremersee.github.io/xmlschemas/garmin/TrackStatsExtension.xsd http://www.garmin.com/xmlschemas/TripExtensions/v1 http://bremersee.github.io/xmlschemas/garmin/TripExtensionsv1.xsd http://www.garmin.com/xmlschemas/TripMetaDataExtensions/v1 http://bremersee.github.io/xmlschemas/garmin/TripMetaDataExtensionsv1.xsd http://www.garmin.com/xmlschemas/UserAccounts/v1 http://bremersee.github.io/xmlschemas/garmin/UserAccountsExtensionv1.xsd http://www.garmin.com/xmlschemas/UserProfile/v1 http://bremersee.github.io/xmlschemas/garmin/UserProfileExtensionv1.xsd http://www.garmin.com/xmlschemas/UserProfile/v2 http://bremersee.github.io/xmlschemas/garmin/UserProfileExtensionv2.xsd http://www.garmin.com/xmlschemas/ViaPointTransportationModeExtensions/v1 http://bremersee.github.io/xmlschemas/garmin/ViaPointTransportationModeExtensionsv1.xsd http://www.garmin.com/xmlschemas/VideoExtension/v1 http://bremersee.github.io/xmlschemas/garmin/VideoExtensionv1.xsd http://www.garmin.com/xmlschemas/WaypointExtension/v1 http://bremersee.github.io/xmlschemas/garmin/WaypointExtensionv1.xsd http://www.garmin.com/xmlschemas/WebLinkExtensions/v1 http://bremersee.github.io/xmlschemas/garmin/WebLinkExtensionsv1.xsd http://www.garmin.com/xmlschemas/WorkoutDatabase/v1 http://bremersee.github.io/xmlschemas/garmin/WorkoutDatabasev1.xsd http://www.garmin.com/xmlschemas/WorkoutExtension/v1 http://bremersee.github.io/xmlschemas/garmin/WorkoutExtensionv1.xsd http://www8.garmin.com/xmlschemas/FlightPlan/v1 http://bremersee.github.io/xmlschemas/garmin/FlightPlanv1.xsd&quot; xmlns=&quot;http://www.garmin.com/xmlschemas/AccelerationExtension/v1&quot; xmlns:ns2=&quot;http://www.garmin.com/xmlschemas/ActiveItemExtensions/v1&quot; xmlns:ns4=&quot;http://www.garmin.com/xmlschemas/ActivityExtension/v2&quot; xmlns:ns3=&quot;http://www.garmin.com/xmlschemas/ActivityExtension/v1&quot; xmlns:ns6=&quot;http://www.garmin.com/xmlschemas/AdventuresExtensions/v1&quot; xmlns:ns5=&quot;http://www.garmin.com/xmlschemas/ActivityGoals/v1&quot; xmlns:ns8=&quot;http://www.garmin.com/xmlschemas/ClientProfile/v1&quot; xmlns:ns51=&quot;http://www.garmin.com/xmlschemas/PowerExtension/v1&quot; xmlns:ns7=&quot;http://www.garmin.com/xmlschemas/CalorieBurnData/v1&quot; xmlns:ns50=&quot;http://www.garmin.com/xmlschemas/WorkoutExtension/v1&quot; xmlns:ns13=&quot;http://www.garmin.com/xmlschemas/DeviceDownload/v1&quot; xmlns:ns9=&quot;http://www.garmin.com/xmlschemas/ConverterPlugin/v1&quot; xmlns:ns12=&quot;http://www.garmin.com/xmlschemas/GarminDeviceExtensions/DataTypeLocation/v1&quot; xmlns:ns11=&quot;http://www.garmin.com/xmlschemas/CreationTimeExtension/v1&quot; xmlns:ns10=&quot;http://www.garmin.com/xmlschemas/CourseExtension/v1&quot; xmlns:ns17=&quot;http://www.garmin.com/xmlschemas/FitnessDeviceLimits/v1&quot; xmlns:ns16=&quot;http://www.garmin.com/xmlschemas/FatCalories/v1&quot; xmlns:ns15=&quot;http://www.garmin.com/xmlschemas/Eula/v1&quot; xmlns:ns14=&quot;http://www.garmin.com/xmlschemas/DirectoryListing/v1&quot; xmlns:ns19=&quot;http://www.garmin.com/xmlschemas/ForerunnerLogbook&quot; xmlns:ns18=&quot;http://www8.garmin.com/xmlschemas/FlightPlan/v1&quot; xmlns:ns42=&quot;http://www.garmin.com/xmlschemas/UserProfile/v1&quot; xmlns:ns41=&quot;http://www.garmin.com/xmlschemas/UserAccounts/v1&quot; xmlns:ns40=&quot;http://www.garmin.com/xmlschemas/TripMetaDataExtensions/v1&quot; xmlns:ns46=&quot;http://www.garmin.com/xmlschemas/VideoExtension/v1&quot; xmlns:ns45=&quot;http://www.garmin.com/xmlschemas/ViaPointTransportationModeExtensions/v1&quot; xmlns:ns44=&quot;http://www.garmin.com/xmlschemas/ProfileExtension/v1&quot; xmlns:ns43=&quot;http://www.garmin.com/xmlschemas/UserProfile/v2&quot; xmlns:ns49=&quot;http://www.garmin.com/xmlschemas/WorkoutDatabase/v1&quot; xmlns:ns48=&quot;http://www.garmin.com/xmlschemas/WebLinkExtensions/v1&quot; xmlns:ns47=&quot;http://www.garmin.com/xmlschemas/WaypointExtension/v1&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:ns31=&quot;http://www.garmin.com/xmlschemas/HardwareVersionExtension/v1&quot; xmlns:ns30=&quot;http://www.garmin.com/xmlschemas/GpxExtensions/v3&quot; xmlns:ns35=&quot;http://www.garmin.com/xmlschemas/PressureExtension/v1&quot; xmlns:ns34=&quot;http://www.garmin.com/xmlschemas/MobileExtensions/v1&quot; xmlns:ns33=&quot;http://www.garmin.com/xmlschemas/iFixExtensions/v1&quot; xmlns:ns32=&quot;http://www.garmin.com/xmlschemas/HistoryDatabase/v1&quot; xmlns:ns39=&quot;http://www.garmin.com/xmlschemas/TripExtensions/v1&quot; xmlns:ns38=&quot;http://www.garmin.com/xmlschemas/TrackStatsExtension/v1&quot; xmlns:ns37=&quot;http://www.garmin.com/xmlschemas/TrackPointExtension/v2&quot; xmlns:ns36=&quot;http://www.garmin.com/xmlschemas/TrackPointExtension/v1&quot; xmlns:ns20=&quot;http://www.garmin.com/xmlschemas/GarminDevice/v1&quot; xmlns:ns24=&quot;http://www.garmin.com/xmlschemas/GarminMobileAppPathExtension/v1&quot; xmlns:ns23=&quot;http://www.garmin.com/xmlschemas/GarminDeviceExtensions/v2&quot; xmlns:ns22=&quot;http://www.garmin.com/xmlschemas/GarminDevice/v2&quot; xmlns:ns21=&quot;http://www.garmin.com/xmlschemas/GarminDeviceExtensions/v1&quot; xmlns:ns28=&quot;http://www.garmin.com/xmlschemas/GpxExtensions/v1&quot; xmlns:ns27=&quot;http://www.garmin.com/xmlschemas/ggz/1/0&quot; xmlns:ns26=&quot;http://www.garmin.com/xmlschemas/GarminTextTranslation/v1&quot; xmlns:ns25=&quot;http://www.garmin.com/xmlschemas/GarminOEMDeviceExtensions/v1&quot; xmlns:ns29=&quot;http://www.garmin.com/xmlschemas/GpxExtensions/v2&quot;&gt;
    &lt;ns30:DisplayColor&gt;Cyan&lt;/ns30:DisplayColor&gt;
&lt;/ns30:TrackExtension&gt;
</pre></div></div>

<p>But if you call the build marshaller method for the current object, you will get only declarations that are necessary:</p>

<div class="source">
<div class="source"><pre class="prettyprint">import java.io.StringWriter;
import java.util.ServiceLoader;
import javax.xml.bind.JAXBException;
import org.bremersee.garmin.gpx.v3.model.ext.DisplayColorT;
import org.bremersee.garmin.gpx.v3.model.ext.TrackExtension;
import org.bremersee.xml.JaxbContextBuilder;
import org.bremersee.xml.JaxbContextDataProvider;

public class Example {

  public static void main(String[] args) throws JAXBException {
    TrackExtension model = new TrackExtension();
    model.setDisplayColor(DisplayColorT.CYAN);

    StringWriter sw = new StringWriter();
    JaxbContextBuilder.builder()
        .withFormattedOutput(true)
        .processAll(ServiceLoader.load(JaxbContextDataProvider.class))
        .buildMarshaller(model) // builds a marshaller with a subset jaxb context
        .marshal(model, sw);
    System.out.println(sw.toString());
  }
}
</pre></div></div>

<p>Then the generated xml looks like this:</p>

<div class="source">
<div class="source"><pre class="prettyprint">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;TrackExtension xsi:schemaLocation=&quot;http://www.garmin.com/xmlschemas/GpxExtensions/v3 http://bremersee.github.io/xmlschemas/garmin/GpxExtensionsv3.xsd&quot; xmlns=&quot;http://www.garmin.com/xmlschemas/GpxExtensions/v3&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;
    &lt;DisplayColor&gt;Cyan&lt;/DisplayColor&gt;
&lt;/TrackExtension&gt;
</pre></div></div>

<p>That&#x2019;s pretty nice, isn&#x2019;t it?</p>
<p>The <code>JaxbContextBuilder</code> scans the object and creates internally a new <code>JAXBContext</code> with all required packages or classes. Since the creation of a jaxb context is quite expensive, the created contexts will be cached and reused, if a further object scan returns the same result.</p>
<p>This dependency resolving can be turned off by setting the resolver to null:</p>

<div class="source">
<div class="source"><pre class="prettyprint">import java.io.StringWriter;
import java.util.ServiceLoader;
import javax.xml.bind.JAXBException;
import org.bremersee.garmin.gpx.v3.model.ext.DisplayColorT;
import org.bremersee.garmin.gpx.v3.model.ext.TrackExtension;
import org.bremersee.xml.JaxbContextBuilder;
import org.bremersee.xml.JaxbContextDataProvider;

public class Example {

  public static void main(String[] args) throws JAXBException {
    TrackExtension model = new TrackExtension();
    model.setDisplayColor(DisplayColorT.CYAN);

    StringWriter sw = new StringWriter();
    JaxbContextBuilder.builder()
        .withFormattedOutput(true)
        .withDependenciesResolver(null) // turns off dependency resolving
        .processAll(ServiceLoader.load(JaxbContextDataProvider.class))
        .buildMarshaller(model)
        .marshal(model, sw);
    System.out.println(sw.toString());
  }
}
</pre></div></div>
</section></section><section>
<h2><a name="Usage_of_SchemaBuilder"></a>Usage of SchemaBuilder</h2>
<p>The schema builder wraps the standard <code>SchemaFactory</code> of Java into a builder. It also offers the ability to load schema using Spring&#x2019;s <code>ResourceLoader</code>.</p>

<div class="source">
<div class="source"><pre class="prettyprint">import javax.xml.validation.Schema;

public class Example {

  public static void main(String[] args) {
    Schema schema = SchemaBuilder.builder()
        .buildSchema(&quot;classpath:common-xml-test-model-1.xsd&quot;,
            &quot;http://bremersee.github.io/xmlschemas/common-xml-test-model-7b.xsd&quot;);
  }
}
</pre></div></div>
</section><section>
<h2><a name="Usage_of_XmlDocumentBuilder"></a>Usage of XmlDocumentBuilder</h2>
<p>The xml document builder wraps the functionality of the standard <code>DocumentBuilderFactory</code> and <code>DocumentBuilder</code> of Java into one builder.</p>
<p>It may be useful to create elements for objects that can contain any element:</p>

<div class="source">
<div class="source"><pre class="prettyprint">import java.io.StringWriter;
import java.util.ArrayList;
import java.util.List;
import javax.xml.bind.JAXBException;
import javax.xml.bind.annotation.XmlAccessType;
import javax.xml.bind.annotation.XmlAccessorType;
import javax.xml.bind.annotation.XmlAnyElement;
import javax.xml.bind.annotation.XmlElementWrapper;
import javax.xml.bind.annotation.XmlRootElement;
import javax.xml.bind.annotation.XmlValue;
import org.w3c.dom.Document;
import org.w3c.dom.Element;

public class Example {

  @XmlRootElement
  @XmlAccessorType(XmlAccessType.FIELD)
  public static class Model {

    @XmlValue
    private String value;

    public String getValue() {
      return value;
    }

    public void setValue(String value) {
      this.value = value;
    }
  }

  @XmlRootElement
  @XmlAccessorType(XmlAccessType.FIELD)
  public static class ModelContainer {

    @XmlElementWrapper(name = &quot;models&quot;)
    @XmlAnyElement
    private List&lt;Element&gt; models;

    public List&lt;Element&gt; getModels() {
      if (models == null) {
        models = new ArrayList&lt;&gt;();
      }
      return models;
    }
  }

  public static void main(String[] args) throws JAXBException {
    Model model = new Model();
    model.setValue(&quot;Hello world!&quot;);

    Document document = XmlDocumentBuilder.builder()
        .buildDocument(model, JaxbContextBuilder.builder().buildMarshaller(model));

    ModelContainer container = new ModelContainer();
    container.getModels().add(document.getDocumentElement());

    StringWriter sw = new StringWriter();
    JaxbContextBuilder.builder().buildMarshaller(container).marshal(container, sw);
    System.out.println(sw.toString());
  }
}
</pre></div></div>

<p>The xml will be:</p>

<div class="source">
<div class="source"><pre class="prettyprint">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;modelContainer&gt;
    &lt;models&gt;
        &lt;model&gt;Hello world!&lt;/model&gt;
    &lt;/models&gt;
&lt;/modelContainer&gt;
</pre></div></div></section>
        </div>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
<p>&copy;2020 bremersee.org</p>
        </div>
      </div>
    </footer>
  </body>
</html>